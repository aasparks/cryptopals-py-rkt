<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Set 1</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Set 1</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Challenge_1%29" class="tocviewlink" data-pltdoc="x">Challenge 1</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Challenge_2%29" class="tocviewlink" data-pltdoc="x">Challenge 2</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Challenge_3%29" class="tocviewlink" data-pltdoc="x">Challenge 3</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.Challenge_4%29" class="tocviewlink" data-pltdoc="x">Challenge 4</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Challenge_5%29" class="tocviewlink" data-pltdoc="x">Challenge 5</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Challenge_6%29" class="tocviewlink" data-pltdoc="x">Challenge 6</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._.Challenge_7%29" class="tocviewlink" data-pltdoc="x">Challenge 7</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#%28part._.Challenge_8%29" class="tocviewlink" data-pltdoc="x">Challenge 8</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._set1%29" class="tocsubseclink" data-pltdoc="x">Set 1</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_1%29" class="tocsubseclink" data-pltdoc="x">Challenge 1</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._ascii-~3ehex%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">ascii-<wbr></wbr>&gt;hex</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._hex-~3eascii%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">hex-<wbr></wbr>&gt;ascii</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._ascii-~3ebase64%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">ascii-<wbr></wbr>&gt;base64</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._base64-~3eascii%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">base64-<wbr></wbr>&gt;ascii</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._hex-~3ebase64%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">hex-<wbr></wbr>&gt;base64</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc1..rkt._base64-~3ehex%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">base64-<wbr></wbr>&gt;hex</span></a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_2%29" class="tocsubseclink" data-pltdoc="x">Challenge 2</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc2..rkt._xorstrs%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">xorstrs</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_3%29" class="tocsubseclink" data-pltdoc="x">Challenge 3</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc3..rkt._score%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">score</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc3..rkt._single-byte-xor%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">single-<wbr></wbr>byte-<wbr></wbr>xor</span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_4%29" class="tocsubseclink" data-pltdoc="x">Challenge 4</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc4..rkt._detect-single-char-xor%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">detect-<wbr></wbr>single-<wbr></wbr>char-<wbr></wbr>xor</span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_5%29" class="tocsubseclink" data-pltdoc="x">Challenge 5</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc5..rkt._repeat-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">repeat-<wbr></wbr>key</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc5..rkt._repeating-key-xor%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">repeating-<wbr></wbr>key-<wbr></wbr>xor</span></a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_6%29" class="tocsubseclink" data-pltdoc="x">Challenge 6</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc6..rkt._hamming-distance%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">hamming-<wbr></wbr>distance</span></a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc6..rkt._break-repeating-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">break-<wbr></wbr>repeating-<wbr></wbr>key</span></a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_7%29" class="tocsubseclink" data-pltdoc="x">Challenge 7</a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._.Challenge_8%29" class="tocsubseclink" data-pltdoc="x">Challenge 8</a></td></tr><tr><td><a href="#%28def._%28%2Fhome%2Fbojack%2F.Dropbox%2Fprojects%2Fcryptopals%2Fcryptopals-rkt%2Fdocs%2Fset1%2Fc8..rkt._is-ecb~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">is-<wbr></wbr>ecb?</span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._set1)"></a>Set 1</h2><p>This is the qualifying set. We picked the exercises in it to
ramp developers up gradually into coding cryptography, but
also to verify that we were working with people who were
ready to write code.</p><p>This set is relatively easy. With one exception, most of
these exercises should take only a couple minutes. But
don&rsquo;t beat yourself up if it takes longer than that.
It took Alex two weeks to get through the set!</p><p>If you&rsquo;ve written any crypto code in the past, you&rsquo;re
going to feel like skipping a lot of this.
Don&rsquo;t skip them. At least two of them (we won&rsquo;t say which)
are important stepping stones to later attacks.</p><h3>1<tt>&nbsp;</tt><a name="(part._.Challenge_1)"></a><a name="(mod-path._.'set1/c1..rkt.')"></a>Challenge 1</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c1.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym">The</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">string:</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">49276d206b696c6c696e6720796f757220627261696e206c</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">696b65206120706f69736f6e6f7573206d757368726f6f6d</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym">Should</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">produce:</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym">So</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">go</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ahead</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">and</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">make</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">that</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">happen.</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">You</span><span class="RktSym">'</span><span class="RktSym">ll</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">need</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">to</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">use</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">this</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">code</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">for</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym">the</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rest</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">of</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">the</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">exercises.</span><span class="RktMeta"></span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._ascii-~3ehex))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">ascii-&gt;hex</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Encodes the ascii byte string into its hex representation.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._hex-~3eascii))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">hex-&gt;ascii</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Decodes the hex byte string into its ascii representation.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._ascii-~3ebase64))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">ascii-&gt;base64</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Encodes the ascii byte string into its base64 representation.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._base64-~3eascii))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">base64-&gt;ascii</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Decodes the base64 byte string into its ascii representation.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._hex-~3ebase64))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">hex-&gt;base64</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Encodes the hex byte string into its base64 representation.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c1..rkt._base64-~3ehex))"></a><span title="Provided from: &quot;set1/c1.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">base64-&gt;hex</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Encodes the base64 byte string into its hex representation.</div></p></div></p><h3>2<tt>&nbsp;</tt><a name="(part._.Challenge_2)"></a><a name="(mod-path._.'set1/c2..rkt.')"></a>Challenge 2</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c2.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara">Write a function that takes two equal-length buffers and produces
their XOR combination.</div><div class="SIntrapara">If your function works properly, then when you feed it the string:</div><div class="SIntrapara"><span class="RktSym">1c0111001f010100061a024b53535009181c</span></div><div class="SIntrapara">...after hex decoding, and when XOR&rsquo;d against:</div><div class="SIntrapara"><span class="RktSym">686974207468652062756c6c277320657965</span></div><div class="SIntrapara">...should produce:</div><div class="SIntrapara"><p><div class="SIntrapara"><span class="RktSym">746865206b696420646f6e277420706c6179</span>
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c2..rkt._xorstrs))"></a><span title="Provided from: &quot;set1/c2.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">xorstrs</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr1</span><span class="hspace">&nbsp;</span><span class="RktVar">bstr2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">XOR&rsquo;s two byte strings together and returns the result.</div></p></div></p><h3>3<tt>&nbsp;</tt><a name="(part._.Challenge_3)"></a><a name="(mod-path._.'set1/c3..rkt.')"></a>Challenge 3</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c3.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara">The hex encoded string:</div><div class="SIntrapara"><span class="RktSym">1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736</span></div><div class="SIntrapara">...hash been XOR&rsquo;d against a single character. Find the key,
decrypt the message.</div><div class="SIntrapara">You can do this by hand. But don&rsquo;t: write code to do it for you.
How? Devise some method for "scoring" a piece of English plaintext.
Character frequency is a good metric. Evaluate each output and choose
the one with the best score.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c3..rkt._score))"></a><span title="Provided from: &quot;set1/c3.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">score</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">pt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">integer?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Scores the given plaintext, <span class="RktVar">pt</span>, from 0-26 using frequency
analysis.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c3..rkt._single-byte-xor))"></a><span title="Provided from: &quot;set1/c3.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">single-byte-xor</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">txt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">byte?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">txt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the key used to encrypt the given ciphertext, <span class="RktVar">txt</span>,
under a single byte xor cipher.</div></p></div></p><h3>4<tt>&nbsp;</tt><a name="(part._.Challenge_4)"></a><a name="(mod-path._.'set1/c4..rkt.')"></a>Challenge 4</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c4.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara"><p><div class="SIntrapara">One of the 60-character strings in this file has been
encrypted by single-character XOR. Find it.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c4..rkt._detect-single-char-xor))"></a><span title="Provided from: &quot;set1/c4.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">detect-single-char-xor</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">file</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">file</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr></table></blockquote></div><div class="SIntrapara">Given a filename, <span class="RktVar">file</span>, containing hex-encoded lines,
finds the line that was encrypted using single character xor and
returns the decrypted line.</div></p></div></p><h3>5<tt>&nbsp;</tt><a name="(part._.Challenge_5)"></a><a name="(mod-path._.'set1/c5..rkt.')"></a>Challenge 5</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c5.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara">Here is the opening stanza of an important work of the
English language:</div><div class="SIntrapara">Burning &rsquo;em, if you ain&rsquo;t quick and nimble
 I go crazy when I hear a cymbal</div><div class="SIntrapara">Encrypt it, under the key "ICE", using repeating-key XOR.</div><div class="SIntrapara">In repeating-key XOR, you&rsquo;ll sequentially apply each byte of the key;
the first byte of plaintext will be XOR&rsquo;d against I, the next C, the next E,
then I again for the 4th byte, and so on.</div><div class="SIntrapara">It should come out to:</div><div class="SIntrapara">0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272
 a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f</div><div class="SIntrapara"><p><div class="SIntrapara">Encrypt a bunch of stuff using your repeating-key XOR function. Encrypt
your mail. Encrypt your password file. Your .sig file. Get a feel for it.
I promise, we aren&rsquo;t wasting your time with this.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c5..rkt._repeat-key))"></a><span title="Provided from: &quot;set1/c5.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">repeat-key</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">integer?</span></td></tr></table></blockquote></div><div class="SIntrapara">Repeats the given <span class="RktVar">key</span> out to a size of <span class="RktVar">n</span>.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c5..rkt._repeating-key-xor))"></a><span title="Provided from: &quot;set1/c5.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">repeating-key-xor</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">txt</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">txt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Performs repeating key encryption on the given <span class="RktVar">txt</span> by
repeating the given <span class="RktVar">key</span> out to <span class="RktPn">(</span><span class="RktSym">bytes-length</span><span class="stt"> </span><span class="RktVar">txt</span><span class="RktPn">)</span>
and XOR&rsquo;ing the two.</div></p></div></p><h3>6<tt>&nbsp;</tt><a name="(part._.Challenge_6)"></a><a name="(mod-path._.'set1/c6..rkt.')"></a>Challenge 6</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c6.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara">There&rsquo;s a file here. It&rsquo;s been base64&rsquo;d after being
encrypted with repeating-key XOR.</div><div class="SIntrapara">Decrypt it.</div><div class="SIntrapara">Here&rsquo;s how:</div><div class="SIntrapara">1. Let KEYSIZE be the guessed length of the key.
      try values from 2 to (say) 40.
   2. Write a function to compute the edit distance
      (Hamming distance) between two strings. Hamming
      distance is the number of differing bits.
   3. For each KEYSIZE, take the first KEYSIZE worth of bytes
      and the second KEYSIZE worth of bytes, and find the edit
      distance between them. Normalize this result by dividing
      by KEYSIZE
   4. The KEYSIZE with the smallest normalized edit distance
      is probably the key. You could proceed perhaps with the smallest 2-3
      KEYSIZE values. Or take 4 KEYSIZE blocks instead of 2.
   5. Now that you probably know the KEYSIZE:
      break the ciphertext into blocks of KEYSIZE
      length.
   6. Now transpose the blocks: make a block that is the first
      byte of every block, and a block that is the second byte of every
      block, and so on.
   7. Solve each block as if it was single-character XOR.
   8. For each block, the single-byte XOR key that produces the best looking
      histogram is the repeating-key XOR key byte for that block. Put them
      together and you have the key.</div><div class="SIntrapara">This code is going to turn out to be surprisingly useful later on. Breaking
repeating-key XOR ("Vigenere") statistically is obviously an academic exercise,
a "Crypto-101" thing. But more people "know how" to break it than can actually
break it, and a similar technique breaks something much more important.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c6..rkt._hamming-distance))"></a><span title="Provided from: &quot;set1/c6.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">hamming-distance</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">bstr1</span><span class="hspace">&nbsp;</span><span class="RktVar">bstr2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">integer?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">bstr2</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Computes the hamming distance between the two given byte strings.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c6..rkt._break-repeating-key))"></a><span title="Provided from: &quot;set1/c6.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">break-repeating-key</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ctxt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ctxt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the key used to encrypt the given ciphertext,
<span class="RktVar">ctxt</span>, under repeating key XOR.</div></p></div></p><h3>7<tt>&nbsp;</tt><a name="(part._.Challenge_7)"></a>Challenge 7</h3><p>The base64-encoded content in this file has been encrypted via
    AES-128 in ECB mode under the key
      "YELLOW SUBMARINE"
    (case-sensitive, without the quotes; exactly 16 characters).
    Decrypt it. You know the key, after all.</p><p>The challenge here was to decrypt a file using AES-128 in ECB mode.
This is provided by the <span class="RktVal">"util/aes.rkt"</span> module above.</p><h3>8<tt>&nbsp;</tt><a name="(part._.Challenge_8)"></a><a name="(mod-path._.'set1/c8..rkt.')"></a>Challenge 8</h3><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="file:///usr/share/doc/racket/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktVal">"set1/c8.rkt"</span><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/base" title="Install this package using `raco pkg install base`"><span class="stt">base</span></a></span></td></tr></table></div><div class="SIntrapara">In this file are a bunch of hex-encoded ciphertexts.</div><div class="SIntrapara">One of them has been encrypted with ECB.</div><div class="SIntrapara">Detect it.</div><div class="SIntrapara"><p><div class="SIntrapara">Remember that the problem with ECB is that it is
stateless and deterministic; the same 16-byte
plaintext block will always produce the same
16-byte ciphertext.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._(/home/bojack/.Dropbox/projects/cryptopals/cryptopals-rkt/docs/set1/c8..rkt._is-ecb~3f))"></a><span title="Provided from: &quot;set1/c8.rkt&quot; | Package: base"><span class="RktSym"><span class="RktSymDef RktSym">is-ecb?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">txt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">txt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Determines if the given <span class="RktVar">txt</span> was encrypted using ECB
mode.</div></p></div></p></div></div><div id="contextindicator">&nbsp;</div></body></html>